<script type="text/javascript" id="tutorialScript">
  document.getElementById('actVars').onclick = function() {
  GEPPETTO.ExperimentsController.watchVariables(
      [Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.naChans.naChan.m.q'),
       Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.naChans.naChan.h.q'),
       Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.kChans.kChan.n.q')], this.checked);
  };

  document.getElementById('gDensity').onclick = function() {
  GEPPETTO.ExperimentsController.watchVariables(
      [Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.naChans.gDensity'),
       Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.kChans.gDensity')], this.checked);
  };

  document.getElementById('iDensity').onclick = function() {
  GEPPETTO.ExperimentsController.watchVariables(
      [Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.naChans.iDensity'),
       Instances.getInstance('HHTutorial.hhpop[0].biophysics.membraneProperties.kChans.iDensity')], this.checked);
  };

  GEPPETTO.on(GEPPETTO.Events.Project_persisted, function() {
      $('.tutorialForm input, .tutorialForm button').prop('disabled', false);
  });

  if (!Project.persisted) {
      $('.tutorialForm input, .tutorialForm button').prop('disabled', true);
  }
  </script>
<div style="color:white">
  <p>A single compartment, (10 μm long, 3.18 μm diameter, 100 μm2 surface area) is being simulated containing a passive leak current (reversal potential -54.3mV) and <a onclick="showModelDescription(Model.neuroml.naChan);">sodium</a> and <a onclick="showModelDescription(Model.neuroml.kChan);">potassium</a> active conductances.<p>

    <p>Below you will see a selection of parameters for you to get a sense of this model. First you must persist the model by <a onclick="Project.persist();">clicking here</a> (or the star icon in the toolbar). This will take a few seconds, then you can modify the parameters and run the simulation by pressing the "Try!" button. Every time you press "Try!" a new experiment will be created. You can find all the experiments that you execute in the tab at the bottom of the browser.</p>

  <p>After the experiment finished running, plots will be displayed for the membrane potential, conductance and current through the Na and K channels.</p>

  <p>In this step the model is in IClamp mode which means you are injecting a current into the cell, you can vary the amplitude of the injected current below.
    A greater amplitude of injection should lead to a higher firing rate. 
    Try reducing the conductance densities of each of the channels to zero and see what happens.</p>

    <div class="tutorialForm center">
        <div class="tutorialLabel">Input current (nA)</div> <input id="currentValue" type="text" value="0.6"></input></br>
        <div class="tutorialLabel">k conductance density (S/cm<sup>2</sup>)</div>
        <input id="kValue" type="text" value="0.036"></input></br>
        <div class="tutorialLabel">na conductance density (S/cm<sup>2</sup>)</div> <input id="naValue" type="text" value="0.12"></input></br>
        <div class="tutorialLabel">Record activation variables</div>
        <input id="actVars" type="checkbox" checked></input></br>
        <div class="tutorialLabel">Record conductance densities</div>
        <input id="gDensity" type="checkbox" checked></input></br>
        <div class="tutorialLabel">Record current densities</div>
        <input id="iDensity" type="checkbox" checked></input></br>
        <button class="btn" id="changeCurrent" onclick="quickExperiment('IClamp',
            {
                _vActive:{'Model.neuroml.hhneuron.vClamp.active':0},
                i:{'Model.neuroml.hhneuron.IClamp.amplitude':$('#currentValue').val()},
                k:{'Model.neuroml.hhneuron.biophysics.membraneProperties.kChans.condDensity':$('#kValue').val()},
                na:{'Model.neuroml.hhneuron.biophysics.membraneProperties.naChans.condDensity':$('#naValue').val()}
            }
        );">Try!</button>
    </div>
</div>
